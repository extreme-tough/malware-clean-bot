AutoItSetOption("SendKeyDelay", 400)

Run("SUPERAntiSpyware.exe")

TraySetToolTip("Waiting for start dialog")
WinWaitActive("SUPERAntiSpyware Free Edition Setup","&Next >",30)
if WinActive("SUPERAntiSpyware Free Edition Setup","&Next >")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("!n")
TraySetToolTip("Waiting for license screen")
WinWaitActive("SUPERAntiSpyware Free Edition Setup","I &accept the license agreement",5)
if WinActive("SUPERAntiSpyware Free Edition Setup","I &accept the license agreement")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("!a")
Send("{ENTER}")
TraySetToolTip("Waiting for user info")
WinWaitActive("SUPERAntiSpyware Free Edition Setup","Full N&ame:",5)
if WinActive("SUPERAntiSpyware Free Edition Setup","Full N&ame:")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for path input")
WinWaitActive("SUPERAntiSpyware Free Edition Setup","Destination Folder",5)
if WinActive("SUPERAntiSpyware Free Edition Setup","Destination Folder")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
$path = ControlGetText("SUPERAntiSpyware Free Edition Setup","","[CLASS:Static; INSTANCE:9]")
Send("{ENTER}")
TraySetToolTip("Waiting for last step")
WinWaitActive("SUPERAntiSpyware Free Edition Setup","Click Next to begin installation.",5)
if WinActive("SUPERAntiSpyware Free Edition Setup","Click Next to begin installation.")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for installation to finish")
WinWaitActive("SUPERAntiSpyware Free Edition Setup","&Finish",120)
if WinActive("SUPERAntiSpyware Free Edition Setup","&Finish")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("!f")
TraySetToolTip("Waiting for language dialog")
While WinExists("SUPERAntiSpyware Language Selection","Select Default Language")=0
	Sleep(1)
WEnd
WinActivate("SUPERAntiSpyware Language Selection","Select Default Language")
WinWaitActive("SUPERAntiSpyware Language Selection","Select Default Language",15)
if WinActive("SUPERAntiSpyware Language Selection","Select Default Language")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for updates prompt")
WinWaitActive("SUPERAntiSpyware","Would you like ",5)
if WinActive("SUPERAntiSpyware","Would you like ")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for updates to finish")
WinWaitActive("SUPERAntiSpyware Setup Wizard","To continue, click Next",240)
if WinActive("SUPERAntiSpyware Setup Wizard","To continue, click Next")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for email dialog")
WinWaitActive("SUPERAntiSpyware Setup Wizard","E-Mail Address",240)
if WinActive("SUPERAntiSpyware Setup Wizard","E-Mail Address")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for update checking prompt")
WinWaitActive("SUPERAntiSpyware Setup Wizard","Enable Automatic Update Check",5)
if WinActive("SUPERAntiSpyware Setup Wizard","Enable Automatic Update Check")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Waiting for Free System Diagnostic Report")
WinWaitActive("SUPERAntiSpyware Setup Wizard","Free System Diagnostic Report",5)
if WinActive("SUPERAntiSpyware Setup Wizard","Free System Diagnostic Report")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
ControlClick("SUPERAntiSpyware Setup Wizard","Free System Diagnostic Report","[CLASS:Button; INSTANCE:1]")
Send("!n")

TraySetToolTip("Waiting for setup complete")
WinWaitActive("SUPERAntiSpyware Setup Wizard","Setup Complete",5)
if WinActive("SUPERAntiSpyware Setup Wizard","Setup Complete")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
Send("{ENTER}")

TraySetToolTip("Waiting for home page protect")
WinWaitActive("SUPERAntiSpyware - Protect Home Page","Protect Home Page",15)
if WinActive("SUPERAntiSpyware - Protect Home Page","Protect Home Page")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
ControlClick("SUPERAntiSpyware - Protect Home Page","","[CLASS:Button; INSTANCE:3]")

TraySetToolTip("Waiting for Main app")
WinWaitActive("SUPERAntiSpyware Free Edition","Scan for Harmful Software",15)
if WinActive("SUPERAntiSpyware Free Edition","Scan for Harmful Software")=0 Then
	if WinActive("SUPERAntiSpyware Definitions Update Reminder","")=1 Then
		Send("{ENTER}")
	Else
		ProcessClose("SUPERAntiSpyware.exe")
		Exit
	EndIf
EndIf
;Click Scan button
ControlClick("SUPERAntiSpyware Free Edition","","[CLASS:Button; INSTANCE:1]")
TraySetToolTip("Waiting for scan window")
WinWaitActive("SUPERAntiSpyware Free Edition","Perform Complete Scan",5)
if WinActive("SUPERAntiSpyware Free Edition","Perform Complete Scan")=0 Then
	ProcessClose("SUPERAntiSpyware.exe")
	Exit
EndIf
ControlClick("SUPERAntiSpyware Free Edition","Perform Complete Scan","[CLASS:Button; INSTANCE:2]")
Send("!n")
Sleep(1000)
TraySetToolTip("Waiting for scan to finish")
WinWaitNotActive("SUPERAntiSpyware Free Edition","Scanning Progress")

;One of the window will appear
if WinActive("SUPERAntiSpyware","No harmful")=1 Then
	Send("{ENTER}")
	WinKill("SUPERAntiSpyware Free Edition")
	ProcessClose("SUPERAntiSpyware.exe")
	Sleep(5000)
	Exit
EndIf

if WinActive("SUPERAntiSpyware Scan Summary","Click the OK")=1 Then
	Send("{ENTER}")
EndIf

WinWaitActive("SUPERAntiSpyware Free Edition")
Send("!n")

TraySetToolTip("Waiting for next dialog")
WinWaitNotActive("SUPERAntiSpyware Free Edition")
;One of the window will appear
if WinActive("SUPERAntiSpyware","You must reboot")=1 Then
	Send("{ESC}")
EndIf

if WinActive("SUPERAntiSpyware","Click the Finish button")=1 Then
	Send("{ENTER}")
	Sleep(1000)
	Send("{ENTER}")	
EndIf
WinKill("SUPERAntiSpyware Free Edition")
ProcessClose("SUPERAntiSpyware.exe")