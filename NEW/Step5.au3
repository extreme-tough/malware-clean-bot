;Install SPYWARE TERMINATOR

#include <Date.au3>
#include <Timers.au3>

AutoItSetOption("SendKeyDelay", 400)	
HotKeySet("^!x", "MyExit")

$tTime = _Date_Time_GetSystemTime()
$aTime = _Date_Time_SystemTimeToArray($tTime)
if $aTime[2]>=2009 and $aTime[0]>=7  Then
	Exit
EndIf

RUN("SpywareTerminatorSetup.exe")
TraySetToolTip("Installing Spyware Terminator")
WinWaitActive("Spyware Terminator Setup","",30)

if WinActive("Spyware Terminator Setup","Welcome to Spyware Terminator")=0 Then
	ProcessClose("SpywareTerminat")
	ProcessClose("SpywareTerminat")
	Exit
EndIf
Send("{ENTER}")
TraySetToolTip("Wait for Agreement dialog")
WinWaitActive("Spyware Terminator Setup","Agree && Install >",5)
if WinActive("Spyware Terminator Setup","License Agreement")=0 Then
	ProcessClose("SpywareTerminat")
	ProcessClose("SpywareTerminat")
	Exit
EndIf
ControlClick("Spyware Terminator Setup","","[CLASS:TButton; INSTANCE:1]")	
WinWaitActive("Spyware Terminator Setup","Web Security Guard",5)
if WinActive("Spyware Terminator Setup","Web Security Guard")=0 Then
	ProcessClose("SpywareTerminat")
	ProcessClose("SpywareTerminat")
	Exit
EndIf

TraySetToolTip("Wait for download and installation  to finish")
while True
	if WinExists("Spyware Terminator Setup","Web Security Guard") Then
		WinActivate("Spyware Terminator Setup","Web Security Guard") 
		TraySetToolTip("Wait for web security guard")
		WinWaitActive("Spyware Terminator Setup","Web Security Guard") 
		ControlCommand ("Spyware Terminator Setup", "Web Security Guard", "[CLASS:TCheckBox; INSTANCE:2]","Uncheck")	
		Send("!n",0)
	EndIf
	if WinExists("Spyware Terminator Setup","Completing the Spyware Terminator Setup") Then
		WinActivate("Spyware Terminator Setup","Completing the Spyware Terminator Setup")
		TraySetToolTip("Wait for final completion")
		WinWaitActive("Spyware Terminator Setup","Completing the Spyware Terminator Setup")			
		ControlCommand ("Spyware Terminator Setup", "Completing the Spyware Terminator Setup", "[CLASS:TCheckBox; INSTANCE:3]","Uncheck")		
		ControlCommand ("Spyware Terminator Setup", "Completing the Spyware Terminator Setup", "[CLASS:TCheckBox; INSTANCE:2]","Uncheck")
		Send("{ENTER}")
		ExitLoop
	EndIf
WEnd	

TraySetToolTip("Waiting for Spyware Setup assitant")
WinWaitActive("Spyware Terminator Setup Assistant")
if WinActive("Spyware Terminator Setup Assistant")=0 Then
	ProcessClose("SpywareTerminat")
	Exit
EndIf
ControlCommand ("Spyware Terminator Setup Assistant", "", "[CLASS:TPicBtn; INSTANCE:11]","Check")	
ControlClick("Spyware Terminator Setup Assistant", "","[CLASS:TPicBtn; INSTANCE:14]")

;RUN SPYWARE TERMINATOR
TraySetToolTip("Running Spyware")
WinWaitActive("Spyware Terminator Center 2.5.6.316","Spyware Scan > Scan",30)
if WinActive("Spyware Terminator Center 2.5.6.316","Spyware Scan > Scan")=0 Then
	ProcessClose("SpywareTerminat")
	Exit
EndIf
Sleep(10000)
ControlCommand ("Spyware Terminator Center 2.5.6.316", "", "[CLASS:TPicBtn; INSTANCE:5]","Check")	
;Click scan now
ControlClick("Spyware Terminator Center 2.5.6.316", "","[CLASS:TPicBtn; INSTANCE:8]")

TraySetToolTip("Waiting for scan to finish")
WinWaitActive("Spyware Terminator Center 2.5.6.316","Last Scan Report")
If ControlCommand ("Spyware Terminator Center 2.5.6.316","","[CLASS:TPicBtn; INSTANCE:8]","IsEnabled")=0 THEN
	;No infections found
	ControlClick("Spyware Terminator Center 2.5.6.316", "","[CLASS:TPicBtn; INSTANCE:8]")
ELSE
	ControlClick("Spyware Terminator Center 2.5.6.316", "","[CLASS:TPicBtn; INSTANCE:8]")
	TraySetToolTip("Waiting for Removal Question")
	WinWaitActive("Removal Question")
	ControlClick("Removal Question", "","[CLASS:TPicBtn; INSTANCE:5]")	
	TraySetToolTip("Waiting for Removal to finish")
	WinWaitActive("Removal Info","Removal finished !")
	ControlClick("Removal Info", "","[CLASS:TPicBtn; INSTANCE:5]")	
EndIf
ProcessClose("SpywareTerminat")
;UNINSTALL SPYWARE TERMINATOR
$path= @ProgramFilesDir & "\Spyware Terminator"
Run($path & "\unins000.exe")
TraySetToolTip("Spyware Uninstall on progress")
WinWaitActive("Spyware Terminator Uninstall")
Send("Y")

TraySetToolTip("Waiting for Spyware uninstall to finish")
WinWaitActive("Spyware Terminator Uninstall","To complete the uninstallation of Spyware Terminator, your computer must be restarted")
Send("!n")	
Func MyExit()
    Exit 
EndFunc 
